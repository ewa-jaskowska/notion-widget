<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Work Timer z szarymi ikonami</title>
<style>
html,body{margin:0;padding:0;height:100%;font-family:Arial,Helvetica,sans-serif;background:transparent;}
.wrap{display:flex;align-items:center;justify-content:center;height:100vh;}
.card{
  background: linear-gradient(135deg,#f0f0f0,#d6d6d6);
  border-radius:16px;
  padding:20px;
  width:300px;
  box-shadow:0 8px 20px rgba(0,0,0,0.1);
  text-align:center;
}
.title{font-size:1rem;font-weight:600;color:#3a3a3a;margin-bottom:10px;}
input#taskName{padding:6px 8px;margin-bottom:10px;border-radius:8px;border:1px solid #ccc;font-size:0.95rem;}
#timerDisplay{
  font-size:2rem;
  margin:10px 0;
  color:#2b2b2b;
}
.controls{display:flex;gap:8px;justify-content:center;margin-top:10px;}
.controls button{
  flex:1;
  padding:8px 0;
  border-radius:10px;
  border:none;
  font-weight:600;
  cursor:pointer;
  background:#fff;
  box-shadow:0 4px 10px rgba(0,0,0,0.05);
  transition:0.1s;
  font-size:1.1rem;
}
/* Ikonki w odcieniach szarości */
#playBtn{color:#2b2b2b;}   /* ciemnoszary */
#stopBtn{color:#555555;}   /* średnioszary */
#resetBtn{color:#888888;}  /* jasny szary */

.controls button:hover{transform:translateY(-1px);}
.taskList{margin-top:12px;text-align:left;max-height:180px;overflow:auto;}
.taskItem{display:flex;justify-content:space-between;align-items:center;background:#e0e0e0;padding:4px 8px;margin-bottom:4px;border-radius:6px;font-size:0.9rem;}
.taskItem button{flex:0 0 auto;padding:2px 6px;font-size:0.8rem;border-radius:6px;border:none;background:#2b2b2b;color:#fff;cursor:pointer;}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <div class="title">Work Timer</div>
    <input id="taskName" type="text" placeholder="Task Name">
    <div id="timerDisplay">00:00:00</div>
    <div class="controls">
      <button id="playBtn" title="Play">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="#2b2b2b" xmlns="http://www.w3.org/2000/svg">
          <polygon points="5,3 19,12 5,21"/>
        </svg>
      </button>
      <button id="stopBtn" title="Stop">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="#555555" xmlns="http://www.w3.org/2000/svg">
          <rect x="5" y="5" width="14" height="14"/>
        </svg>
      </button>
      <button id="resetBtn" title="Reset">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="#888888" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6h-2c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/>
        </svg>
      </button>
    </div>
    <div class="taskList" id="taskList"></div>
  </div>
</div>

<script>
const timerDisplay = document.getElementById('timerDisplay');
const playBtn = document.getElementById('playBtn');
const stopBtn = document.getElementById('stopBtn');
const resetBtn = document.getElementById('resetBtn');
const taskNameInput = document.getElementById('taskName');
const taskListDiv = document.getElementById('taskList');

let running = false;
let startTs = null;
let accMs = 0;
let interval = null;
let currentTask = null;

const STORAGE_KEY = 'work_timer_tasks';

function pad(n){ return String(n).padStart(2,'0'); }
function msToHMS(ms){
  const h=Math.floor(ms/3600000);
  const m=Math.floor((ms%3600000)/60000);
  const s=Math.floor((ms%60000)/1000);
  return `${pad(h)}:${pad(m)}:${pad(s)}`;
}

function updateDisplay(){
  const elapsed = accMs + (running && startTs ? Date.now() - startTs : 0);
  timerDisplay.textContent = msToHMS(elapsed);
}

// ---- Timer actions ----
function startTimer(){
  if(running) return;
  if(!currentTask) {
    const name = taskNameInput.value.trim();
    if(!name) { alert("Podaj nazwę zadania"); return; }
    currentTask = { name, duration: accMs };
  }
  running = true;
  startTs = Date.now();
  playBtn.disabled = true;
  interval = setInterval(updateDisplay, 250);
}

function stopTimer(){
  if(!running) return;
  accMs += Date.now() - startTs;
  startTs = null;
  running = false;
  playBtn.disabled = false;
  updateDisplay();
  saveCurrentTask();
}

function resetTimer(){
  running = false;
  startTs = null;
  accMs = 0;
  interval && clearInterval(interval);
  playBtn.disabled = false;
  currentTask = null;
  updateDisplay();
}

// ---- Task storage ----
function loadTasks(){
  try{
    const raw = localStorage.getItem(STORAGE_KEY);
    return raw ? JSON.parse(raw) : [];
  } catch(e){ return []; }
}

function saveTasks(tasks){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks));
}

function saveCurrentTask(){
  if(!currentTask) return;
  currentTask.duration = accMs;
  let tasks = loadTasks();
  const idx = tasks.findIndex(t=>t.name===currentTask.name);
  if(idx>=0){ tasks[idx] = currentTask; } else { tasks.push(currentTask); }
  saveTasks(tasks);
  renderTaskList();
}

  function deleteTask(name){
  let tasks = loadTasks();
  tasks = tasks.filter(t => t.name !== name);
  saveTasks(tasks);
  renderTaskList();
}


// ---- Render ----
function renderTaskList(){
  const tasks = loadTasks();
  taskListDiv.innerHTML = '';
  tasks.forEach(t=>{
    const div = document.createElement('div');
    div.className='taskItem';

    const span = document.createElement('span');
    span.textContent = `${t.name} - ${msToHMS(t.duration)}`;
    div.appendChild(span);

    // przycisk kontynuacji
    const btnContinue = document.createElement('button');
    btnContinue.textContent = 'Continue';
    btnContinue.onclick = ()=>{
      accMs = t.duration;
      currentTask = {...t};
      updateDisplay();
    };
    div.appendChild(btnContinue);

    // przycisk usuwania
    const btnDelete = document.createElement('button');
    btnDelete.textContent = 'Usuń';
    btnDelete.style.background = '#aa0000';
    btnDelete.onclick = ()=>deleteTask(t.name);
    div.appendChild(btnDelete);

    taskListDiv.appendChild(div);
  });
}


// ---- Event listeners ----
playBtn.addEventListener('click', startTimer);
stopBtn.addEventListener('click', stopTimer);
resetBtn.addEventListener('click', resetTimer);
window.addEventListener('beforeunload', ()=>{ saveCurrentTask(); });

renderTaskList();
updateDisplay();
</script>
</body>
</html>
