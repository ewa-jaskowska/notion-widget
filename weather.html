<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Notion Weather Widget (Daily, Gray-White Theme, Emoji)</title>
<style>
/* Layout and color palette inspired by the provided style */
body, html{height:100%;margin:0;display:flex;align-items:center;justify-content:center;background:#f2f2f2;font-family:Inter,system-ui,sans-serif}
.widget{background:linear-gradient(135deg,#f0f0f0,#d6d6d6);border-radius:16px;padding:20px;width:320px;box-shadow:0 8px 20px rgba(0,0,0,0.1);text-align:center}
.city{font-size:1rem;font-weight:600;color:#3a3a3a;margin-bottom:10px}
.time{font-size:0.85rem;color:#555555;margin-bottom:12px}
.temp{font-size:2rem;margin:10px 0;color:#2b2b2b;font-weight:700}
.desc{font-size:0.95rem;color:#555555;margin-bottom:14px}
input.city-input{padding:6px 8px;margin-bottom:10px;border-radius:8px;border:1px solid #ccc;font-size:0.95rem;width:100%;box-sizing:border-box}
button{flex:1;padding:8px 0;border-radius:10px;border:none;font-weight:600;cursor:pointer;background:#fff;box-shadow:0 4px 10px rgba(0,0,0,0.05);transition:0.1s;font-size:1.1rem;margin-top:6px}
button:hover{transform:translateY(-1px)}
.forecast{display:flex;gap:10px;overflow:auto;margin-top:14px;padding-bottom:6px}
.day-card{min-width:84px;padding:10px;border-radius:12px;background:#e0e0e0;text-align:center}
.day-name{font-weight:700;margin-bottom:6px;color:#555555}
.small{font-size:0.82rem;color:#555555}
.error{color:#ff8080;margin-top:8px}
footer{font-size:0.75rem;color:#555555;margin-top:12px}
</style>
</head>
<body>
<div class="widget" id="widget">
<div class="city" id="city">‚Äî</div>
<div class="time" id="time">‚Äî</div>
<div class="temp" id="temp">‚Äî</div>
<div class="desc" id="desc">‚Äî</div>
<input class="city-input" id="cityInput" placeholder="Enter city (e.g. Warsaw)" />
<button id="searchBtn">Search</button>
<div class="forecast" id="forecast"></div>
<div class="error" id="error"></div>
<footer>Source: Open-Meteo (no API key). Daily forecast.</footer>
</div>
<script>
const DEFAULT_CITY='Warsaw';
const FORECAST_DAYS=7;
function el(id){return document.getElementById(id)}
function fmtDateISO(dateStr){const d=new Date(dateStr+'T00:00:00');return d.toLocaleDateString(undefined,{weekday:'short',month:'short',day:'numeric'})}
// Mapping weather code to English description + emoji
const weatherCodeMap={0:['Clear sky','‚òÄÔ∏è'],1:['Mainly clear','üå§Ô∏è'],2:['Partly cloudy','‚õÖ'],3:['Overcast','‚òÅÔ∏è'],45:['Fog','üå´Ô∏è'],61:['Slight rain','üåßÔ∏è'],95:['Thunderstorm','‚õàÔ∏è']};
function codeToDesc(code){return weatherCodeMap[code]||['Unknown','üåà']}
async function geocode(city){
const url=`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(city)}&count=1&language=en&format=json`;
const res=await fetch(url);
if(!res.ok)throw new Error('Geocoding error');
const data=await res.json();
if(!data.results||data.results.length===0)throw new Error('City not found');
return data.results[0];
}
async function fetchWeather(lat,lon,timezone='auto'){
const params=new URLSearchParams({latitude:lat,longitude:lon,timezone:timezone,daily:'temperature_2m_max,temperature_2m_min,weathercode',forecast_days:FORECAST_DAYS});
const url=`https://api.open-meteo.com/v1/forecast?${params.toString()}`;
const res=await fetch(url);
if(!res.ok)throw new Error('Weather fetch error');
return await res.json();
}
async function updateForCity(city){el('error').textContent='';try{const g=await geocode(city);const w=await fetchWeather(g.latitude,g.longitude,g.timezone||'auto');renderCurrent(`${g.name}${g.admin1?(", "+g.admin1):''}`,g,w);}catch(err){el('error').textContent=err.message;}}
function renderCurrent(locationName,geo,data){const todayIdx=0;el('city').textContent=`${locationName}${geo.country?(', '+geo.country):''}`;el('time').textContent=`Updated: ${new Date().toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'})}`;const tmax=data.daily.temperature_2m_max[todayIdx];const tmin=data.daily.temperature_2m_min[todayIdx];const wc=data.daily.weathercode[todayIdx];const [desc,emoji]=codeToDesc(wc);el('temp').textContent=`${Math.round(tmax)}¬∞ / ${Math.round(tmin)}¬∞`;el('desc').textContent=desc+' '+emoji;const fc=el('forecast');fc.innerHTML='';const days=data.daily.time;for(let i=0;i<days.length;i++){const dateStr=days[i];const tmaxD=data.daily.temperature_2m_max[i];const tminD=data.daily.temperature_2m_min[i];const wcD=data.daily.weathercode[i];const [dDesc,dEmoji]=codeToDesc(wcD);const div=document.createElement('div');div.className='day-card';div.innerHTML=`<div class="day-name">${fmtDateISO(dateStr)}</div><div style="font-size:1.2rem">${dEmoji}</div><div style="font-weight:700">${Math.round(tmaxD)}¬∞ / ${Math.round(tminD)}¬∞</div><div class="small">${dDesc}</div>`;fc.appendChild(div);}}
el('searchBtn').addEventListener('click',()=>{const v=el('cityInput').value.trim();if(v)updateForCity(v);});
el('cityInput').addEventListener('keydown',(e)=>{if(e.key==='Enter')el('searchBtn').click();});
updateForCity(DEFAULT_CITY);
</script>
</body>
</html>
